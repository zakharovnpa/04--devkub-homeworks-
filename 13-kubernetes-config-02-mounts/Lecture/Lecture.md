### Лекция по теме "13.2 Разделы и монтирование"

Андрей
Копылов

### 1Андрей Копылов
TechLead
PremiumBonus

### 2План занятия
1. Терминология
2. Возможности
3. Отличия от Docker
4. Типы хранилищ
5. Применения
6. Итоги
7. Домашнее задание

### 3Терминология
- Volume (том) — директория, хранящаяся за
пределами подов.
- Persistent Volume (PV) — внешнее хранилище,
подключаемое к контейнерам.
- StorageClass — динамически создает PV.
- Persistent Volume Claim (PVC) — элемент для связи
подов и PV.

### 4Возможности
- позволяет хранить данные в файловой системе
ноды / внешнем хранилище;
- поддерживает различные реализации хранилища;
- может ограничивать доступ (чтение/запись для
одного/нескольких подов);

### 5Отличия от Docker Volumes
- В докере: локальные папки и реже nfs.
- В kubernetes: PV — это интерфейс, за ним может быть
и внешнее хранилище на блочном устройстве или
облако.

### 6EmptyDir
- применяется для создания общей папки в поде;
- у каждого пода своя папка;
- при перезапуске создается заново.

### 7Persistent Volume Claim
- нужен для подключения внешнего постоянного
хранилища;
- можно называть запросом на хранилище;
- описывает минимальные требования к хранилищу;
- после подключения к тому доступен для подов;
- описывает принцип работы после отключения —
удаление, очистка, сохранение данных.

### 8Схема PVC
![shema-pvc](/13-kubernetes-config-02-mounts/Files/shema-pvc.png)

### 9Persistent Volume
- может быть несколько в кластере;
- можно создавать динамически через StorageClass;
- доступны различные плагины для хранилищ.

### 10Persistent Volume: local
- подключает локальную папку с текущей ноды;
- на каждой ноде будет создана своя папка;
- лучше всего применять совместно со statefuset.

### 11Persistent Volume: nfs
- подключает внешнюю папку к ноде, а ее — в под;
- можно создать общий сервер и подключать в
кластер;
- нужно учитывать передачу данных по сети.

### 12Persistent Volume: CephFS
- внешний кластер можно запустить как угодно;
- работает быстрее nfs;
- можно подключить общую папку ко множеству подов.

![cephfs](/13-kubernetes-config-02-mounts/Files/cephfs.png)

### 13Persistent Volume: облачные решения
- можно использовать готовые решения от облаков;
- каждое облако имеет готовые плагины:
awsElasticBlockStore, gcePersistentDisk, azureDisk;
- упрощает работу с хранилищами в кластерах.

### 14Когда применять
- хранить состояние базы данных;
- шарить статику сайта;
- хранить общие логи и собирать;
- передавать файлы между подами.

### 15Итоги
Сегодня мы изучили:
- из чего состоит хранилище в Kubernetes;
- какие решения можно применять;
- когда стоит применять внешние тома.

### 16Домашнее задание
Давайте посмотрим ваше домашнее задание.
- Вопросы по домашней работе задавайте в чате мессенджера
Slack.
- Задачи можно сдавать по частям.
- Зачёт по домашней работе проставляется после того, как приняты
все задачи.

### 17Задавайте вопросы и
пишите отзыв о лекции!
Андрей Копылов
