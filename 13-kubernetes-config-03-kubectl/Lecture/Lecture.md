## Лекция по теме "13.3 Работа с kubectl"

Андрей
Копылов

- Для работы bash-completion
```
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi
```

### 1Андрей Копылов
TechLead
PremiumBonus

### 2План занятия
1. Возможности
2. Разные кластеры/пользователи
3. Базовые команды
4. Проксирование трафика
5. Применение файлов
6. Итоги
7. Домашнее задание

### 3Возможности
● гибкое управление конфигурациями;
● можно настроить разные конфигурации для разных
кластеров;
● быстрое переключение между контекстами;
● переключение через переменную окружения
KUBECONFIG.

### Главный помощник: --help
● флаг есть у каждой команды и подкоманды;
● выводит примеры и описания флагов/команд.

### Разные кластеры в конфиге
Меняем командой 
```kubectl
conﬁg set-cluster <cluster
name>.
Новые добавить той же
командой, указав флаги:

● --server
● --certiﬁcate-authority.
```
  
### Разные пользователи в кластере
Добавить пользователя можно
командой:
kubectl conﬁg set-credentials.
Удалить пользователя:
kubectl conﬁg delete-user.

### Просмотр логов
Команда: 
```kubectl logs <type>/<name>
Флаги:
● -c — уточнение контейнера;
● -p — просмотр логов прошлого запуска пода;
● --since — за какой период получить логи;
● --all-containers — получить логи всех контейнеров;
● -f — следить за логами в реальном времени.
```
  
### Редактирование ресурсов
Команда: 
```
kubectl edit <type>/<name>
Флаги:
● -o — формат конфигурации для редактирования;
● --save-conﬁg — сохранять ли конфиг в аннотации.
```
  
### Проксирование трафика
Команда: 
```kubectl port-forward <type>/<name> <port>
Как можно задать порты:
● 8000 5000 — сразу несколько;
● 9000:http — по названию в сервисе/поде;
● 7000:8000 — с локального 7000 на порт 8000 пода;
● :9000 — на рандомный локальный порт.
```
  
### Выполнение команд
Команда: 
```
kubectl exec <pod name> <command>
Флаги:
● -с — уточнение контейнера для выполнения;
● -ti — два флага для интерактивного доступа.
```
### Редактирование меток/аннотаций
Команды: 
```
kubectl label <type> <label>
kubectl annotate <type> <annotate>
Флаги:
● --all — обновление всех ресурсов в неймспейсе;
● -ti — два флага для интерактивного доступа.
```

### Работа через файлы
Команды: 
```
kubectl apply -f <ﬁlename>
kubectl delete -f <ﬁlename>
Флаги:
● -n — неймспейс для применения.
```

### Итоги
Сегодня мы изучили:
● базовые команды работы с kubectl;
● как переключать кластеры;
● различные сценарии работы с командой.

### 14Домашнее задание
Давайте посмотрим ваше домашнее задание.
● Вопросы по домашней работе задавайте в чате мессенджера
● Задачи можно сдавать по частям.
● Зачёт по домашней работе проставляется после того, как приняты
все задачи.
15Задавайте вопросы и
пишите отзыв о лекции!
Андрей Копылов
